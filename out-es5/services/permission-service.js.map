{"version":3,"sources":["../../out/services/permission-service.js"],"names":["__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","Object","defineProperty","exports","service_1","require","errors_1","events_1","PermissionService","path","baseUrl","errors","serviceUrlCanntNull","item","argumentNull","url","postByJson","assign","menuType","args","filter","getResourceList","id","r","dataItem","dataItems","o","children","parent_id","map","visible","data","sortExpression","getByJson","unexpectedNullResult","i","length","buttonType","roleId","resourceIds","userId","roleIds","mobile","getUserList","deleteByJson","type","smsId","verifyCode","password","Service","loginInfo","events","logout","fire","setStorageLoginInfo","username","login","register","user","roles","userIds"],"mappings":"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","sourcesContent":["\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst service_1 = require(\"./service\");\r\nconst errors_1 = require(\"../errors\");\r\nconst events_1 = require(\"../events\");\r\nclass PermissionService extends service_1.Service {\r\n    constructor() {\r\n        super();\r\n    }\r\n    url(path) {\r\n        if (!PermissionService.baseUrl)\r\n            throw errors_1.errors.serviceUrlCanntNull('permissionService');\r\n        return `${PermissionService.baseUrl}/${path}`;\r\n    }\r\n    //=============================================================\r\n    // 资源相关\r\n    /** 添加资源 */\r\n    addResource(item) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!item)\r\n                throw errors_1.errors.argumentNull('item');\r\n            let url = this.url('resource/add');\r\n            let result = yield this.postByJson(url, { item });\r\n            Object.assign(item, result);\r\n            return result;\r\n        });\r\n    }\r\n    /** 更新资源 */\r\n    updateResource(item) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!item)\r\n                throw errors_1.errors.argumentNull('item');\r\n            let url = this.url('resource/update');\r\n            let result = yield this.postByJson(url, { item });\r\n            Object.assign(item, result);\r\n            return result;\r\n        });\r\n    }\r\n    /** 获取菜单类型的资源 */\r\n    getMenuResources() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            let menuType = 'menu';\r\n            let args = {\r\n                filter: `(type = \"${menuType}\")`\r\n            };\r\n            return this.getResourceList(args);\r\n        });\r\n    }\r\n    getMenuItem(id) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            let args = {};\r\n            args.filter = `id = '${id}' or parent_id = '${id}'`;\r\n            let r = yield this.getResourceList(args);\r\n            let dataItem = r.dataItems.filter(o => o.id == id)[0];\r\n            if (!dataItem)\r\n                return null;\r\n            dataItem.children = r.dataItems.filter(o => o.parent_id == id)\r\n                .map(o => Object.assign({ children: [], visible: o.data.visible }, o));\r\n            return dataItem;\r\n        });\r\n    }\r\n    /** 获取资源列表 */\r\n    getResourceList(args) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!args)\r\n                throw errors_1.errors.argumentNull('args');\r\n            let url = this.url('resource/list');\r\n            if (!args.sortExpression)\r\n                args.sortExpression = 'sort_number asc';\r\n            let result = yield this.getByJson(url, { args });\r\n            if (result == null)\r\n                throw errors_1.errors.unexpectedNullResult();\r\n            for (let i = 0; i < result.dataItems.length; i++) {\r\n                result.dataItems[i].data = result.dataItems[i].data || {};\r\n            }\r\n            return result;\r\n        });\r\n    }\r\n    /**\r\n     * 删除指定的资源\r\n     * @param id 要删除的资源编号\r\n     */\r\n    deleteResource(id) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!id)\r\n                throw errors_1.errors.argumentNull('id');\r\n            let url = this.url('resource/remove');\r\n            return this.postByJson(url, { id });\r\n        });\r\n    }\r\n    /**\r\n     * 获取指定资源的子按钮\r\n     * @param id 资源编号\r\n     */\r\n    getResourceChildCommands(id) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!id)\r\n                throw errors_1.errors.argumentNull('id');\r\n            let buttonType = 'button';\r\n            let filter = `parent_id = '${id}' and type = '${buttonType}'`;\r\n            let url = `resource/list`;\r\n            let result = yield this.getByJson(url, { filter });\r\n            return result;\r\n        });\r\n    }\r\n    //=============================================================\r\n    // 角色相关\r\n    /**\r\n     * 获取角色列表\r\n     */\r\n    getRoles() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            let url = this.url('role/list');\r\n            let r = yield this.getByJson(url);\r\n            return r || [];\r\n        });\r\n    }\r\n    /**\r\n     * 获取单个角色\r\n     * @param id 要获取的角色编号\r\n     */\r\n    getRole(id) {\r\n        if (!id)\r\n            throw errors_1.errors.argumentNull('id');\r\n        let url = this.url('role/get');\r\n        return this.getByJson(url, { id });\r\n    }\r\n    /**\r\n     *\r\n     * @param roleId 指定的角色编号\r\n     * @param resourceIds 角色所允许访问的资源编号\r\n     */\r\n    setRoleResource(roleId, resourceIds) {\r\n        if (!roleId)\r\n            throw errors_1.errors.argumentNull('roleId');\r\n        if (!resourceIds)\r\n            throw errors_1.errors.argumentNull('resourceIds');\r\n        let url = this.url('role/setResources');\r\n        return this.postByJson(url, { roleId, resourceIds });\r\n    }\r\n    /**\r\n     * 获取角色所允许访问的资源 id\r\n     * @param roleId 指定的角色编号\r\n     */\r\n    getRoleResourceIds(roleId) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!roleId)\r\n                throw errors_1.errors.argumentNull('roleId');\r\n            let url = this.url('role/resourceIds');\r\n            let r = yield this.getByJson(url, { roleId });\r\n            return r || [];\r\n        });\r\n    }\r\n    /** 设置用户角色 */\r\n    setUserRoles(userId, roleIds) {\r\n        if (!userId)\r\n            throw errors_1.errors.argumentNull('userId');\r\n        if (!roleIds)\r\n            throw errors_1.errors.argumentNull('roleIds');\r\n        let url = this.url('user/setRoles');\r\n        return this.postByJson(url, { userId, roleIds });\r\n    }\r\n    //================================================================\r\n    // 用户相关\r\n    /** 获取用户列表 */\r\n    getUserList(args) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            let url = this.url('user/list');\r\n            let result = yield this.getByJson(url, { args });\r\n            if (result == null)\r\n                throw errors_1.errors.unexpectedNullResult();\r\n            return result;\r\n        });\r\n    }\r\n    /** 通过手机获取用户 */\r\n    getUserByMobile(mobile) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!mobile)\r\n                throw errors_1.errors.argumentNull('mobile');\r\n            let args = {};\r\n            args.filter = `mobile = '${mobile}'`;\r\n            let r = yield this.getUserList(args);\r\n            return r.dataItems[0];\r\n        });\r\n    }\r\n    /**\r\n     * 移除当前应用的用户\r\n     * @param userId 要移除的用户编号\r\n     */\r\n    removeUser(userId) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!userId)\r\n                throw errors_1.errors.argumentNull('userId');\r\n            let url = this.url('application/removeUser');\r\n            return this.deleteByJson(url, { userId });\r\n        });\r\n    }\r\n    /**\r\n     * 获取当前应用的所有用户\r\n     * @param args 数据源选择参数\r\n     */\r\n    getApplicatinUsers(args) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (args == null)\r\n                throw errors_1.errors.argumentNull('args');\r\n            let url = this.url('application/users');\r\n            let result = yield this.getByJson(url, { args });\r\n            if (result == null)\r\n                throw errors_1.errors.unexpectedNullResult();\r\n            return result;\r\n        });\r\n    }\r\n    /**\r\n     * 发送注册操作验证码\r\n     * @param mobile 接收验证码的手机号\r\n     */\r\n    sendRegisterVerifyCode(mobile) {\r\n        let url = this.url('sms/sendVerifyCode');\r\n        return this.postByJson(url, { mobile, type: 'register' });\r\n    }\r\n    /**\r\n     * 校验验证码\r\n     * @param smsId 验证码信息的 ID 号\r\n     * @param verifyCode 验证码\r\n     */\r\n    checkVerifyCode(smsId, verifyCode) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!smsId)\r\n                throw errors_1.errors.argumentNull('smsId');\r\n            if (!verifyCode)\r\n                throw errors_1.errors.argumentNull('verifycode');\r\n            let url = this.url('sms/checkVerifyCode');\r\n            let r = yield this.postByJson(url, { smsId, verifyCode });\r\n            return r;\r\n        });\r\n    }\r\n    /**\r\n     * 发送重置密码操作验证码\r\n     * @param mobile 接收验证码的手机号\r\n     */\r\n    sendResetVerifyCode(mobile) {\r\n        if (!mobile)\r\n            throw errors_1.errors.argumentNull('mobile');\r\n        let url = this.url('sms/sendVerifyCode');\r\n        return this.postByJson(url, { mobile, type: 'resetPassword' });\r\n    }\r\n    /**\r\n     * 重置密码\r\n     * @param mobile 手机号\r\n     * @param password 新密码\r\n     * @param smsId 短信编号\r\n     * @param verifyCode 验证码\r\n     */\r\n    resetPassword(mobile, password, smsId, verifyCode) {\r\n        if (!mobile)\r\n            throw errors_1.errors.argumentNull('mobile');\r\n        if (!password)\r\n            throw errors_1.errors.argumentNull('password');\r\n        if (!smsId)\r\n            throw errors_1.errors.argumentNull('smsId');\r\n        if (!verifyCode)\r\n            throw errors_1.errors.argumentNull('verifyCode');\r\n        let url = this.url('user/resetPassword');\r\n        return this.postByJson(url, { mobile, password, smsId, verifyCode });\r\n    }\r\n    /**\r\n     * 重置手机号码\r\n     * @param mobile 需要重置的新手机号\r\n     * @param smsId 短信编号\r\n     * @param verifyCode 验证码\r\n     */\r\n    resetMobile(mobile, smsId, verifyCode) {\r\n        if (!mobile)\r\n            throw errors_1.errors.argumentNull('mobile');\r\n        if (!smsId)\r\n            throw errors_1.errors.argumentNull('smsId');\r\n        if (!verifyCode)\r\n            throw errors_1.errors.argumentNull('verifyCode');\r\n        let url = this.url('user/resetMobile');\r\n        return this.postByJson(url, { mobile, smsId, verifyCode });\r\n    }\r\n    /**\r\n     * 退出登录\r\n     */\r\n    logout() {\r\n        if (service_1.Service.loginInfo.value == null)\r\n            return;\r\n        //TODO: 将服务端 token 设置为失效\r\n        events_1.events.logout.fire(this, service_1.Service.loginInfo.value);\r\n        service_1.Service.setStorageLoginInfo(null);\r\n        service_1.Service.loginInfo.value = null;\r\n    }\r\n    /**\r\n     * 登录\r\n     * @param username 用户名\r\n     * @param password 密码\r\n     */\r\n    login(username, password) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!username)\r\n                throw errors_1.errors.argumentNull('username');\r\n            if (!password)\r\n                throw errors_1.errors.argumentNull('password');\r\n            let url = this.url('user/login');\r\n            let r = yield this.postByJson(url, { username, password });\r\n            if (r == null)\r\n                throw errors_1.errors.unexpectedNullResult();\r\n            service_1.Service.loginInfo.value = r;\r\n            service_1.Service.setStorageLoginInfo(r);\r\n            events_1.events.login.fire(this, r);\r\n            return r;\r\n        });\r\n    }\r\n    /**\r\n     * 注册\r\n     * @param mobile 手机号\r\n     * @param password 密码\r\n     * @param smsId 短信编号\r\n     * @param verifyCode 验证码\r\n     */\r\n    register(mobile, password, smsId, verifyCode, data) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!mobile)\r\n                throw errors_1.errors.argumentNull('mobile');\r\n            if (!password)\r\n                throw errors_1.errors.argumentNull('password');\r\n            if (!smsId)\r\n                throw errors_1.errors.argumentNull('smsId');\r\n            if (!verifyCode)\r\n                throw errors_1.errors.argumentNull('verifyCode');\r\n            let url = this.url('user/register');\r\n            let r = yield this.postByJson(url, { mobile, password, smsId, verifyCode, data });\r\n            if (r == null)\r\n                throw errors_1.errors.unexpectedNullResult();\r\n            service_1.Service.setStorageLoginInfo(r);\r\n            events_1.events.register.fire(this, r);\r\n            return r;\r\n        });\r\n    }\r\n    /**\r\n     * 获取用户个人信息\r\n     */\r\n    me() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!service_1.Service.loginInfo.value) {\r\n                return null;\r\n            }\r\n            let url = this.url('user/me');\r\n            let user = yield this.getByJson(url);\r\n            return user;\r\n        });\r\n    }\r\n    /**\r\n     * 获取用户\r\n     * @param userId 用户编号\r\n     */\r\n    getUser(userId) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            let url = this.url('user/item');\r\n            let user = yield this.getByJson(url, { userId });\r\n            return user;\r\n        });\r\n    }\r\n    /**\r\n     * 添加用户信息\r\n     * @param item 用户\r\n     */\r\n    addUser(item) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            let url = this.url('user/add');\r\n            let result;\r\n            let r = yield this.postByJson(url, { item });\r\n            return r;\r\n        });\r\n    }\r\n    /**\r\n     * 更新用户信息\r\n     * @param item 用户\r\n     */\r\n    updateUser(item) {\r\n        let url = this.url('user/update');\r\n        return this.postByJson(url, { user: item });\r\n    }\r\n    /**\r\n     * 获取当前登录用户的角色\r\n     */\r\n    myRoles() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            let url = this.url('user/getRoles');\r\n            let roles = yield this.getByJson(url);\r\n            return roles;\r\n        });\r\n    }\r\n    /**\r\n     * 给指定的用户添加角色\r\n     * @param userId 用户编号\r\n     * @param roleIds 多个角色编号\r\n     */\r\n    addUserRoles(userId, roleIds) {\r\n        let url = this.url('user/addRoles');\r\n        return this.postByJson(url, { userId, roleIds });\r\n    }\r\n    /**\r\n     * 获取用角色\r\n     * @param userId 用户编号\r\n     */\r\n    getUserRoles(userId) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            let url = this.url('role/userRoles');\r\n            let r = yield this.getByJson(url, { userIds: [userId] });\r\n            return r[userId];\r\n        });\r\n    }\r\n}\r\nexports.PermissionService = PermissionService;\r\n// export interface User {\r\n//     id: string,\r\n//     user_name: string,\r\n//     mobile: string,\r\n//     email: string,\r\n//     password: string,\r\n//     sort_number: number,\r\n//     data?: any\r\n//     // roleIds: string[]\r\n// }\r\n"],"file":"permission-service.js"}